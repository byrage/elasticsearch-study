### ES - Basic Concepts
문서에 나온 주요한 용어를 표기할 때는 가독성을 위해 영어로 쓰려고 노력함

#### Near Realtime(NRT)
- 문서를 색인하고 검색 가능할때 까지 일반적으로 1초의 대기시간이 있다는 것
- 거어어어의 실시간

#### Cluster
- 전체 데이터를 유지하고, Index를 제공하고, 각 Node간의 검색을 가능하게 해주는 1개 이상의 Node(서버) 컬렉션
- Cluster는 유니크한 이름으로 식별된다. 디폴트 이름은 'elasticsearch'
- 이름이 중요한 이유는 Node가 Cluster에 구성될 때 이름을 가지고 구성 되기 때문. 중복해서 쓰지마라
- Node가 하나인 Cluster를 구성하는게 베스트라고함. 당연히 그렇겠지.. 뭐든 조심하는게

#### Node
- Cluster의 일부가 되는 싱글 서버. 데이터를 저장하고 Cluster의 인덱싱과 검색 기능에 참여한다.
- Cluster와 같이 Node 또한 이름으로 구분되는데, 디폴트 이름은 Node가 시작될때 할당받은 랜덤한 UUID이다.
- Node에도 이름을 부여할 수 있다. 이름은 관리에 있어서 중요하다. Cluster 내에 어떤 Node인지 식별하기 위해. 당연히 그렇겠지...
- 특정 Cluster에 이름을 가지고 참여(Join) 가능. 따로 설정을 하지 않은 경우 각각의 Node는 'elasticsearch'라는 이름의 Cluster에 참여한다.
- 네트워크상에 Node가 하나도 없다면 싱글 Node가 'elasticsearch'라는 이름의 Cluster로 시작된다.

#### Index
- 비슷한 특징을 가지는 문서 컬렉션
- 예를 들어 고객 데이터를 위한 Index, 다른 Index는 상품 카탈로그를 또 다른 카탈로그는 주문데이터를 가지고 있는 Index를 가질 수 있다.
- Index는 ** 소문자**로 된 이름으로 식별되며 이 이름은 인덱싱, 검색, 업데이트, 삭제 기능에 사용된다.

#### Type
- 6.0.0에 Deprecated됨
- 다른 타입을 동일한 Index에 저장하기 위해 사용 되었던 논리적인 분류 ex) 유저 / 블로그 포스트

#### Document
- Index 될 수 있는 기본 정보
- 예를 들어 하나의 사용자, 하나의 제품, 하나의 주문이 있을 때 이 Document는 JSON으로 나타낼 수 있다.
- Index 내부에 원하는 만큼의 Document를 저장 할 수 있다.

#### Shards
- Index는 싱글 노드의 하드웨어 용량을 초과하는 양의 데이터를 저장할 수 있다.
- 예를 들어 1TB 크기의 10억개 Document를 가지고 있는 인덱스는 싱글노드의 디스크에 적합하지 않고, 검색요청을 싱글 노드 하나로 처리하는 것은 속도가 엄청 느려짐
- 이러한 문제를 해결하기 위해 ** Index**를 ** Shards**라고 불리는 여러개의 조각으로 나누는 기능을 제공함
- 인덱스 생성 시에 간단하게 몇개의 샤드를 원하는지 정의할 수 있음
- 각각의 샤드는 완벽한 기능과 클러스터 내의 어떤 노드에도 속할 수 있는 독립적인 인덱스를 가지고 있음
- 샤드가 중요한 2가지 이유
  1. 볼륨을 수평으로 split, scale 가능
  1. 각각의 샤드간에 분산, 병렬의 작업 가능 -> 퍼포먼스와 throughput 상승!
- 샤드가 분산되는 것과 검색 후에 모이는 것은 ES에 의해 관리되고 사용자에게 투명하다.
- 클라우드 환경에서는 짱짱 좋으나 샤드/노드가 분실될 경우 failover를 사용하셈

#### Replicas
- 1개 이상의 샤드를 복사하는 것을 replica shards 또는 replicas라고 함
- Replicas가 중요한 2가지 이유
  1.  샤드/노드에 높은 가용성을 제공. 그러기 위해서는 replicas가 원본 노드에는 배치되면 안됨
  1. scale out을 통해 각각의 replicas를 병렬로 실행 가능

#### Shards & Replicas 요약
- 각각의 인덱스는 여러개의 샤드로 나뉠 수 있다.
- 인덱스는 0번 이상 Replicated 될 수 있다.
- Shards와 Replicas 개수는 인덱스가 생성되기 전에 정의 할 수 있다. 인덱스 생성 후에는 replicas 숫자를 동적으로 변경할 수 있지만, shards 수는 변경할 수 없다. -> 당연한듯 복제는 맘대로지만 나누는 것은 이미 저질러 버려서..
- 기본적으로 ES는 5개의 primary shards와 1개의 replica를 할당한다. 예를 들어 2개의 노드가 클러스터에 있다면, 인덱스는 5개의 primary shards와 5개의 replicas(1개의 완벽한 replica)를 가짐. 인덱스당 10개의 shards를 가진다는 얘기
- ES 샤드는 Lucene Index라네. lucene index는 2147483519개의 documents를 가질 수 있음. _cat/shards를 API 콜로 샤드 사이즈를 모니터링 할 수 있다고함. -> 각각의 샤드가 Lucene의 Index안에 구성되기 때문에 Lucene index보다 많은 개수의 샤드를 가질 수 없다는 뜻인가보다... 말을 왜케 어렵게 썼지

### Afterword
- Shard라는 용어가 인덱스를 나누는것 까지인가.. 나누고 배치하는 것 까지인가? 나중에 옵션으로 테스트 해보자
- 챕터의 A to Z를 번역하면서 문서를 작성했는데, 시간이 오래걸려 효율적이진 않은데 집중은 확실히 잘되는 느낌이 든다.
